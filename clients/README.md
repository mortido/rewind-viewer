# Clients

Ready to use:

 - C++17
 - C++17 cmake project
 - Python3 - uses JSON serialization as it is faster than flatbuffers on python

Not implemented:

 - C# **[template generated by ChatGpt]**
 - Go **[template generated by ChatGpt]**
 - Java **[template generated by ChatGpt]**
 - Kotlin **[template generated by ChatGpt]**
 - rust **[template generated by ChatGpt]**
 - TypeScript **[template generated by ChatGpt]**

Original clients [implementation](https://github.com/kswaldemar/rewind-viewer/tree/develop/clients) can be used as reference.

# Message protocol v5/v6

Rewind viewer uses FlatBuffers (v5 [message schema](https://github.com/mortido/rewind-viewer/blob/develop/fbs/rewind_message.fbs)) and JSON (v6) for control message serialization.

Viewer accepts the following types of commands:
 - Arc,
 - CameraView,
 - Circle,
 - CircleSegment,
 - LogText,
 - Options,
 - Polyline,
 - Popup,
 - PopupRound,
 - Rectangle,
 - Tiles,
 - Triangle,
 - EndFrame

### Vector2f
Structure for 2D coordinates and sizes
```
x:float;
y:float;
```

### Color
Color value is encoded as uint32 in form `ARGB`

DEPRECATED: ~~But zero alpha component means fully opaque object instead of invisible one.~~
```
value:uint32;
fill:bool;   # used by some primitives to fill them with specified color
```
Example:
```
0xffff0000    # red
0x7700ff00    # transparent green
0xff0000ff    # blue
0xff000033    # dark blue
```

### Arc
```
color:Color;        # Color (fill supported)
center:Vector2f;    # Center position
radius:float;       # Radius
start_angle:float;  # Arc start angle in radians
end_angle:float;    # Arc end angle in radians
```

### CameraView
Specifies position and area of camera view
```
name:string;        # Name to show in UI
position:Vector2f;  # Camera position
view_radius:float;  # Requested viewport size
```

### Circle
```
color:Color;        # Color (fill supported)
center:Vector2f;    # Center position
radius:float;       # Radius
```

### CircleSegment (pie piece)
```
color:Color;        # Color (fill supported)
center:Vector2f;    # Center position
radius:float;       # Radius
start_angle:float;  # Segment start angle in radians
end_angle:float;    # Segment end angle in radians
```

### LogText
Messages will be shown in `Frame message` window inside viewer.
You can send several messages during one frame. Newline added automatically after each message
Escape characters also allowed, e.g. you can send `multilined\nstring`
```
text:string
```

### Options
```
map:Map;
layer:Layer;

Layer {
  id:uint;                   # Set active layer (0-9) for primitives
  use_permanent_frame:bool;  # Whenever to draw primitives to permanent layer
}

Map {
  position:Vector2f; # Position of left bottom corner
  size:Vector2f;     # Map size, x - width, y - height
  x_grid:uint16;     # Map x cells count (used to draw grid)
  y_grid:uint16;     # Map y cells count (used to draw grid)
}
```

### Polyline
```
color:Color;        # Color (fill not supported)
points:[Vector2f];  # Arbitrary points count (atleast 2 points)
```

### Popup
Shows popup window with message when cursor overlaps with given rectangular area.
```
text:string;             # Text to be displayed (escape characters as \n are allowed)
area_position:Vector2f;  # Position (least x and y coordinates)
area_size:Vector2f;      # Size of area (width, heigh)
```

### PopupRound:
Shows popup window with message when cursor overlaps with given circular area.
```
text:string;             # Text to be displayed (escape characters as \n are allowed)
area_center:Vector2f     # Center position
area_radius:float;       # Area radius
```

### Rectangle
```
color:Color;        # Color (fill supported)
position:Vector2f;  # Position (least x and y coordinates)
size:Vector2f;      # Size (width, height)  
```

### Tiles
```
position:Vector2f;  # Start position of 1st cell left bottom point
cell_size:Vector2f; # Size of 1 cell
row_size:uint16;    # Cells per row
colors:[uint32];    # Array of color values in ARGB format, if alpha is zero tile is ignored
```

### Ttriangle
```
color:Color;        # Color (fill supported)
points:[Vector2f];  # Exactly 3 points
```

### End
Don't have any data. Indicates and of frame. All objects will be drawn after it (buffered mode).
